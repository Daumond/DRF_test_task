
# Электронная торговая сеть

Тестовое задание.  
Это веб-приложение создано для управления иерархической структурой торговой сети электроники. Проект разработан на Django и Django REST Framework.

## Содержание

- [Технические требования](#технические-требования)
- [Установка](#установка)
- [Запуск приложения](#запуск-приложения)
- [Использование](#использование)
  - [Доступ к админке](#доступ-к-админке)
  - [Работа с API](#работа-с-api)
- [Фикстуры](#фикстуры)
- [Документация](#документация-проекта)

## Технические требования

Для запуска проекта вам понадобится:

- Python 3.8+
- Django 3+
- Django REST Framework 3.10+
- PostgreSQL 10+
- Виртуальное окружение для Python

## Установка

1. **Клонирование репозитория:**

   ```bash
   git clone https://github.com/Daumond/DRF_test_task.git
   cd DRF_test_task
   ```

2. **Создание и активация виртуального окружения:**

   ```bash
   python3 -m venv venv
   source venv/bin/activate
   ```

3. **Установка зависимостей:**

   ```bash
   poetry install
   ```

4. **Настройка базы данных:**

   Убедитесь, что PostgreSQL установлен и настроен на вашем устройстве. Затем создайте базу данных:

   ```sql
   CREATE DATABASE electronics_db;
   ```

   Обновите переменные окружения в `sample.env` и переименуйте его в `.env`:


5. **Применение миграций:**

   ```bash
   python manage.py migrate
   ```

6. **Загрузка фикстур:**

   ```bash
   python manage.py loaddata users_fixture.json
   python manage.py loaddata nodes_fixture.json
   python manage.py loaddata products_fixture.json
   ```

## Запуск приложения

1. **Запуск сервера разработки:**

   ```bash
   python manage.py runserver
   ```

   Сервер будет доступен по адресу `http://127.0.0.1:8000/`.

## Использование

### Доступ к админке

1. Перейдите по адресу `http://127.0.0.1:8000/admin/`.
2. Войдите под учетными данными, указанными в фикстурах:
   - **Логин:** `admin`
   - **Пароль:** `admin`
3. В админке вы можете управлять нодами и продуктами, использовать фильтры и выполнять действия, такие как очистка задолженности перед поставщиком.

### Работа с API

API предоставляет CRUD-операции для нод сети. Для работы с API можно использовать инструменты вроде Postman или curl.

Примеры запросов:

- **Получение всех нод:**

  ```bash
  curl -X GET "http://127.0.0.1:8000/api/nodes/" -H "Authorization: Token <ваш_токен>"
  ```

- **Фильтрация нод по стране:**

  ```bash
  curl -X GET "http://127.0.0.1:8000/api/nodes/?country=Россия" -H "Authorization: Token <ваш_токен>"
  ```

- **Создание новой ноды:**

  ```bash
  curl -X POST "http://127.0.0.1:8000/api/nodes/" -H "Authorization: Token <ваш_токен>" -d '{
    "name": "Розничная сеть D",
    "email": "retailD@example.com",
    "country": "Россия",
    "city": "Казань",
    "street": "Московская",
    "house_number": "15",
    "level": 1,
    "supplier": 1
  }'
  ```

- **Обновление ноды (задолженность не изменяется):**

  ```bash
  curl -X PUT "http://127.0.0.1:8000/api/nodes/1/" -H "Authorization: Token <ваш_токен>" -d '{
    "name": "Завод A",
    "email": "newfactoryA@example.com",
    "country": "Россия",
    "city": "Москва",
    "street": "Ленина",
    "house_number": "10",
    "level": 0
  }'
  ```

## Фикстуры

Фикстуры загружают начальные данные в базу данных:

- **Пользователи:** `users_fixture.json`
- **Ноды сети:** `nodes_fixture.json`
- **Продукты:** `products_fixture.json`

Эти фикстуры можно использовать для тестирования и демонстрации функционала приложения.

## Документация проекта

В проекте реализована документация с использованием Swagger и ReDoc:

Swagger: <http://127.0.0.1:8000/swagger/>
ReDoc: <http://127.0.0.1:8000/redoc/>

